<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html> 
<head> 
	<title>Google Maps V3 test</title> 
	<meta http-equiv="content-type" content="text/html; charset=utf-8" /> 
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
	<script type="text/javascript"> 

		function GetQueryString() {
			if (1 < document.location.search.length) {
				// 最初の1文字 (?記号) を除いた文字列を取得する
				var query = document.location.search.substring(1);

				// クエリの区切り記号 (&) で文字列を配列に分割する
				var parameters = query.split('&');

				var result = new Object();
				for (var i = 0; i < parameters.length; i++) {
					// パラメータ名とパラメータ値に分割する
					var element = parameters[i].split('=');

					var paramName = decodeURIComponent(element[0]);
					var paramValue = decodeURIComponent(element[1]);

					// パラメータ名をキーとして連想配列に追加する
					result[paramName] = decodeURIComponent(paramValue);
				}
				return result;
			}
			return null;
		}

		google.maps.event.addDomListener(window, 'load', function() 
		{ 
			var mapOptions = { 
				zoom: 12, 
				center: null, 
				mapTypeId: google.maps.MapTypeId.ROADMAP, 
				scaleControl: true 
			}; 
			var mapObj = new google.maps.Map(document.getElementById('gmap'), mapOptions); 


			// ルートを表示するマップを設定 
			var directionsRenderer = new google.maps.DirectionsRenderer(); 
			directionsRenderer.setMap(mapObj); 


			var param = GetQueryString();

//			var wayPoints = [];

			// 経由地点を設定 
//			if(param["way"] != "") {
//				wayPoints = [{location: param["way"]}];
//			}

			// 開始地点と終了地点、ルーティングの種類の設定
			var request = {
				origin: param['from'], 
				destination: param['to'], 
				travelMode: google.maps.DirectionsTravelMode.WALKING, 
				waypoints: wayPoints 
			}; 


			// ルート検索を行う 
			var directionsService = new google.maps.DirectionsService(); 
			directionsService.route(request, function(result, status) 
			{ 
				if (status == google.maps.DirectionsStatus.OK) { 
					directionsRenderer.setDirections(result); 
				} 
			}); 
		}); 
	</script> 
</head> 
<body> 
	<div id="gmap" style="width: 99%; height: 370px; border: 1px solid Gray;"> 
	</div> 
</body> 
</html> 